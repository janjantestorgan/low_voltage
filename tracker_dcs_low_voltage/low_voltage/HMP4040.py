#for python2 
#import visa
#rm = visa.ResourceManager("/usr/lib64/librsvisa.so@ni")
#for python3
import pyvisa as visa
rm = visa.ResourceManager("/usr/lib64/librsvisa.so@ivi")
HMP4040 = rm.open_resource('TCPIP::192.168.1.203::10002::SOCKET')
HMP4040.read_termination = '\n'
HMP4040.write_termination = '\n'
HMP4040.write("*IDN?")
idn = HMP4040.read()
print("IDN:", idn)
HMP4040.set_visa_attribute(visa.constants.VI_ATTR_TERMCHAR_EN,True)
attr = HMP4040.get_visa_attribute(visa.constants.VI_ATTR_TERMCHAR_EN)
print("Attrib. TERMCHAR_EN:", attr)
HMP4040.set_visa_attribute(visa.constants.VI_ATTR_SUPPRESS_END_EN,False)
attr = HMP4040.get_visa_attribute(visa.constants.VI_ATTR_SUPPRESS_END_EN)
print("Attrib. SUPPRESS_END_EN:", attr)
#HMP4040.set_visa_attribute(visa.constants.VI_ATTR_SEND_END_EN,True)
#attr = HMP4040.get_visa_attribute(visa.constants.VI_ATTR_SEND_END_EN)
#print("Attrib. SEND_END_EN:", attr)
print()

HMP4040.write("INST:NSEL 1")
HMP4040.write("INST:NSEL?")
Channel = HMP4040.read()
print("Channel  :  ",  Channel)
HMP4040.write("MEAS:VOLT?")
V1 = HMP4040.read()
print("V1 : ",V1)
HMP4040.write("MEAS:CURR?")
I1 = HMP4040.read()
print("I1 : ",I1)
print()

HMP4040.write("INST:NSEL 2")
HMP4040.write("INST:NSEL?")
Channel = HMP4040.read()
print("Channel  :  ",  Channel)
HMP4040.write("MEAS:VOLT?")
V2 = HMP4040.read()
print("V2 : ",V2)
HMP4040.write("MEAS:CURR?")
I2 = HMP4040.read()
print("I2 : ",I2)
print()

HMP4040.write("INST:NSEl 3")
HMP4040.write("INST:NSEL?")
Channel = HMP4040.read()
print("Channel  :  ",  Channel)
HMP4040.write("MEAS:VOLT?")
V3 = HMP4040.read()
print("V3 : ",V3)
HMP4040.write("MEAS:CURR?")
I3 = HMP4040.read()
print("I3 : ",I3)
print()

HMP4040.write("INST:NSEL 4")
HMP4040.write("INST:NSEL?")
Channel = HMP4040.read()
print("Channel  :  ",  Channel)
HMP4040.write("MEAS:VOLT?")
V4 = HMP4040.read()
print("V4 : ",V4)
HMP4040.write("MEAS:CURR?")
I4 = HMP4040.read()
print("I4 : ",I4)
print()

HMP4040.close()



